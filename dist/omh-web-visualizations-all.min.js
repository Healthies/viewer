!function(t,e){var a="OMHWebVisualizations";t[a]=e(t,a)}(this,function(t,e){var a=t.hasOwnProperty(e)?t[e]:{};return a.ChartConfiguration=function(t,e){var n,i,o=function(t){var a;if("_systolic_blood_pressure_diastolic_blood_pressure"===t.omhDatum.groupName){var n=t.omhDatum.body.systolic_blood_pressure.value.toFixed(0),i=t.omhDatum.body.diastolic_blood_pressure.value.toFixed(0);a=n+"/"+i}else{var o="undefined"!=typeof e.decimalPlaces?e.decimalPlaces:1;a=t.y.toFixed(o)}return a},r={userInterface:{toolbar:{enabled:!0},timespanButtons:{enabled:!0},zoomButtons:{enabled:!0},navigation:{enabled:!0},thresholds:{show:!0},tooltips:{enabled:!0,timeFormat:"M/D/YY, h:mma",decimalPlaces:0,contentFormatter:o,grouped:!0},panZoom:{enabled:!0,showHint:!0},axes:{yAxis:{visible:!0},xAxis:{visible:!0}}},measures:{body_weight:{valueKeyPath:"body.body_weight.value",range:{min:0,max:100},units:"kg",thresholds:{max:57}},heart_rate:{valueKeyPath:"body.heart_rate.value",range:{min:30,max:150},units:"bpm"},step_count:{valueKeyPath:"body.step_count",range:{min:0,max:1500},units:"Steps",seriesName:"Steps",timeQuantizationLevel:a.DataParser.QUANTIZE_DAY,quantizedDataConsolidationFunction:a.DataParser.consolidators.summation,chart:{type:"clustered_bar",barColor:"#eeeeee",daysShownOnTimeline:{min:7,max:90}}},minutes_moderate_activity:{valueKeyPath:"body.minutes_moderate_activity.value",range:{min:0,max:300},units:"Minutes",seriesName:"Minutes of moderate activity",timeQuantizationLevel:a.DataParser.QUANTIZE_DAY,quantizedDataConsolidationFunction:a.DataParser.consolidators.summation,chart:{type:"clustered_bar",daysShownOnTimeline:{min:7,max:90}}},systolic_blood_pressure:{valueKeyPath:"body.systolic_blood_pressure.value",range:{min:30,max:200},units:"mmHg",thresholds:{max:120}},diastolic_blood_pressure:{valueKeyPath:"body.diastolic_blood_pressure.value",range:{min:30,max:200},units:"mmHg",thresholds:{max:80}}}},s={range:{min:0,max:100},units:"Units",seriesName:"Series",timeQuantizationLevel:a.DataParser.QUANTIZE_NONE,quantizedDataConsolidationFunction:a.DataParser.consolidators.average,chart:{type:"line",pointSize:9,lineColor:"#dedede",pointFillColor:"#4a90e2",pointStrokeColor:"#0066d6",aboveThresholdPointFillColor:"#e8ac4e",aboveThresholdPointStrokeColor:"#745628",barColor:"#4a90e2",daysShownOnTimeline:{min:1,max:1e3}}},l=function(){n=a.Utils.mergeObjects(r,e),i=d3.keys(n.measures),i.forEach(function(t){n.measures[t]=a.Utils.mergeObjects(s,n.measures[t])})};this.getMeasureSettings=function(t){return n.measures[t]},this.getPrimaryMeasureSettings=function(){return n.measures[t[0]]},this.getInterfaceSettings=function(){return n.userInterface},l.call(this)},a}),function(t,e){var a="OMHWebVisualizations";t[a]=e(t,a)}(this,function(t,e){var a=t.hasOwnProperty(e)?t[e]:{};return a.ChartInteractions=function(t,e,a,n){var i,o,r,s,l,u,c,d,m,f,h,p,g,v,b,y,P,x,D,_,S=864e5,T=e.getInterfaceSettings(),w={},A={},M=function(t){d&&(t=Math.max(t,d)),m&&(t=Math.min(t,m));var e=f.domain(),a=[e[0],new Date(e[0].getTime()+t*S)];f.domain(a)},E=function(t){return(t[1].getTime()-t[0].getTime())/S},N=function(t){var e=f.domain(),a=E(e);a*=(100-t)/100,d&&(a=Math.max(a,d)),m&&(a=Math.min(a,m));var n=[e[0],new Date(e[0].getTime()+a*S)];f.domain(n)},C=function(t){var e=f.domain(),a=E(e);a*=t/100;var n=[new Date(e[0].getTime()+a*S),new Date(e[1].getTime()+a*S)];f.domain(n)},O=function(){d3.selectAll(".time-button").classed("active",!1)},I=function(t){g=new Plottable.Interactions.Pointer,g.onPointerExit(function(t){v.hide()}),g.onPointerEnter(y.bind(this)),P=function(e){var a;try{a=t.entityNearest(e),b(a),y()}catch(n){return}},g.onPointerMove(P),g.attachTo(t),x=t},z=function(t){T.panZoom.enabled&&(u=new Plottable.Interactions.PanZoom,c=new Plottable.Interactions.PanZoom,u.addXScale(t.xScale),u.attachTo(t.plotGroup),c.addXScale(t.xScale),c.attachTo(t.xAxis),d&&(u.minDomainExtent(t.xScale,d*S),c.minDomainExtent(t.xScale,d*S)),m&&(u.maxDomainExtent(t.xScale,m*S),c.maxDomainExtent(t.xScale,m*S)))},F=function(t){var e=[];d3.entries(a.getAllMeasureData()).forEach(function(t){var a=t.value;a.forEach(function(t){e.push(t.x)})});var n=t.extentOfValues(e),i=n[1].getTime()-n[0].getTime(),o=m*S;i>o&&(n[1]=new Date(n[0].getTime()+o)),t.domain(n)},U=function(){i=new Plottable.Interactions.Drag,o=function(){p&&p(),v&&y&&y()},i.onDrag(o)},H=function(){r=function(){y&&y(),O&&O(),p&&p()}},Z=function(){l=new Plottable.Components.Label("( Drag chart to pan, pinch or scroll to zoom )",0).padding(10).yAlignment("bottom").xAlignment("right").addClass("zoom-hint-label"),p=function(){l.addClass("hidden")};var t=((new Plottable.Interactions.Click).attachTo(l).onClick(function(t){p()}),e.getPrimaryMeasureSettings().chart.daysShownOnTimeline);d=t?t.min:!1,m=t?t.max:!1},k=function(){if(T.toolbar.enabled){if(h=t.append("div").classed("omh-chart-toolbar",!0).attr("unselectable","on"),T.timespanButtons.enabled){var e={"1wk":7,"1m":30,"3m":90,"6m":180};h.append("span").classed("time-buttons-label",!0).text("Show: "),d3.entries(e).forEach(function(t){var e=t.value,a=t.key;if((!m||m>=e)&&(!d||e>=d)){var n=h.append("span").classed("time-button",!0).text(a);n.on("click",function(){O(),M(e),d3.select(this).classed("active",!0)})}})}if(T.zoomButtons.enabled){var a={"&#8722;":-20,"&#43;":20};h.append("span").classed("zoom-buttons-label",!0).text(" Zoom: "),d3.entries(a).forEach(function(t){var e=t.value,a=t.key,n=h.append("span").classed("zoom-button",!0).html(a);n.on("click",function(){O(),N(e)})})}if(T.navigation.enabled){var n=h.append("span",":first-child").classed("previous-time-period-button",!0).text("< prev");n.on("click",function(){C(-100)});var i=h.append("span").classed("next-time-period-button",!0).text("next >");i.on("click",function(){C(100)})}}},Q=function(){if(T.tooltips.enabled){var t=null,e=null,a=function(t){e=t.selection.style("opacity"),t.selection.style("opacity","1")},i=function(t){t.selection.style("opacity",e)},o=function(t,e){A[t][e].forEach(function(t){a(t)})},r=function(t,e){A[t][e].forEach(function(t){i(t)})},s=function(t){v.show(t.datum,t.selection[0][0])},l=function(t){t&&_&&(t.selection[0][0].getBoundingClientRect().left>_[0][0].getBoundingClientRect().left&&t.selection[0][0].getBoundingClientRect().right<_[0][0].getBoundingClientRect().right?s(t):v.hide())};y=function(){if(t&&_)if(t.datum.primary||!T.tooltips.grouped)l(t);else{var e=w[t.datum.omhDatum.groupName][t.index],a=d3.select(".d3-tip").node().clientHeight;l(e.selection[0][0].getBoundingClientRect().top>_[0][0].getBoundingClientRect().top+a?e:t)}},b=function(e){if(null!==t){var a=T.tooltips.grouped,n=e.datum.omhDatum.body!==t.datum.omhDatum.body,i=e.datum.measure!==t.datum.measure,s=a?n:n||i;s&&(r(t.datum.omhDatum.groupName,t.index),t=e,o(t.datum.omhDatum.groupName,e.index))}else t=e;null===e.datum};var u=function(t){var e;if(T.tooltips&&"undefined"!=typeof T.tooltips.contentFormatter)e=T.tooltips.contentFormatter(t);else{var a="undefined"!=typeof T.decimalPlaces?T.decimalPlaces:1;e=t.y.toFixed(a)}var n='<div class="value">'+e+"</div>",i=T.tooltips.timeFormat;return n+='<div class="time">'+moment(t.x).format(i)+"</div>",n+='<div class="provider">'+t.provider+"</div>"};v=d3.tip().attr("class","d3-tip").html(function(e){var a=t.component,i=n.resolveStyleNameForDatumInPlot(e,a);i=i.toLowerCase().replace(/[^a-z0-9]+/g,"_");var o=e.measure+" "+i;return'<div class="omh-tooltip '+o+'">'+u(e)+"</div>"})}},V=function(){U(),H(),Z(),k(),Q()};this.getTooltip=function(){return v},this.getToolbar=function(){return h},this.getPanZoomInteraction=function(){return u},this.getpanZoomInteractionXAxis=function(){return c},this.addToComponents=function(t){for(var e in t.plots){var a=t.plots[e];if(a instanceof Plottable.Plots.Scatter&&a.datasets()&&a.datasets().length>0){I(a);break}}z(t),m&&F(t.xScale),T.enabled&&T.showHint&&t.plots.push(l),i.attachTo(t.table),D=t.table,f=t.xScale},this.addToSelection=function(t){_=t,s&&s.offWheel(r),s=new Plottable.Dispatchers.Mouse.getDispatcher(_[0][0]).onWheel(r),v&&_.call(v)},this.addTooltipsToEntities=function(t){w={},A={},t.forEach(function(t){var e=t.datum.omhDatum.groupName;w[e]||(w[e]=[]),t.datum.primary&&(w[e][t.index]=t),A[e]||(A[e]=[]),A[e][t.index]||(A[e][t.index]=[]),A[e][t.index].push(t)})},this.destroy=function(){g&&g.offPointerMove(P),g&&g.detachFrom(x),i&&i.detachFrom(D),v&&v.destroy(),s&&s.offWheel(r),y&&i.offDrag(y),h&&h.remove()},V.call(this)},a}),function(t,e){var a="OMHWebVisualizations";t[a]=e(t,a)}(this,function(t,e){var a=t.hasOwnProperty(e)?t[e]:{};return a.ChartStyles=function(t){var e=[],a=function(e){return t.getMeasureSettings(e.measure).thresholds},n={measure:function(t){return function(e){return e.measure===t}},above:function(t){return function(e){return e.y>t}},aboveThresholdMax:function(){return function(t){var e=a(t),n=e?e.max:null;return n?t.y>n:!1}},below:function(t){return function(e){return e.y<t}},belowThresholdMin:function(){return function(t){var e=a(t),n=e?e.min:null;return n?t.y<n:!1}},dailyBeforeHour:function(t){return function(e){return e.x.getHours()<t}}};this.filters=n,this.getDefaultStylesForPlot=function(t){var e={Scatter:[{name:"default",attributes:{fill:"#4a90e2",stroke:"#0066d6","stroke-width":"1px",size:9,opacity:.5}},{name:"above",filters:[n.aboveThresholdMax()],attributes:{fill:"#e8ac4e",stroke:"#745628"}},{name:"below",filters:[n.belowThresholdMin()],attributes:{fill:"#e8ac4e",stroke:"#745628"}}],Line:[{name:"default",attributes:{stroke:"#dedede","stroke-width":"1px"}}],ClusteredBar:[{name:"default",attributes:{fill:"#4a90e2"}},{name:"secondary",filters:[function(t){return!t.primary}],attributes:{fill:"#eeeeee"}}]},a=e[t.constructor.name];return a?a:{}},this.applyFilters=function(t,e){for(j=0;j<t.length;j++)if(!t[j](e))return!1;return!0},this.getAttributeValueAccessor=function(t,e){return function(a){var n=this.resolveAttributeValue(t,a);return n?n:e(a)}.bind(this)},this.getStylesKeyedByAttributeName=function(t){var e={};return t.forEach(function(t){var a=Object.getOwnPropertyNames(t.attributes);a.forEach(function(a){e[a]||(e[a]=[]);var n={filters:t.filters,value:t.attributes[a]};e[a].push(n)})}),e},this.getFilteredProperty=function(t,e,a){for(i=a.length-1;i>=0;i--){var n=a[i].filters,o=a[i][e];if(!n)return o;if(this.applyFilters(n,t))return o}return null},this.resolveAttributeValue=function(t,e){return this.getFilteredProperty(e,"value",t)},this.getStylesForPlot=function(t){for(var a in e)if(e[a].plot===t)return e[a].styles},this.setStylesForPlot=function(t,a){var n=this.getStylesForPlot(a);n?n.styles=t:e.push({plot:a,styles:t}),this.assignAttributesToPlot(t,a)},this.resolveStyleNameForDatumInPlot=function(t,e){var a=this.getStylesForPlot(e);return a?this.getFilteredProperty(t,"name",a):null},this.assignAttributesToPlot=function(t,e){var a=this.getStylesKeyedByAttributeName(t);for(var n in a)"size"===n?(defaultAccessor=e.size()?e.size().accessor:null,e.size(this.getAttributeValueAccessor(a[n],defaultAccessor))):(defaultAccessor=e.attr(n)?e.attr(n).accessor:null,e.attr(n,this.getAttributeValueAccessor(a[n],defaultAccessor)))},this.addToSelection=function(t){var e=t.select("defs")[0][0];e=e?d3.select(e):t.append("defs");var a=e.select("#y-axis-gradient")[0][0];a||(a=e.append("linearGradient").attr("id","y-axis-gradient").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%").attr("spreadMethod","pad"),a.append("stop").attr("offset","0%").attr("stop-color","#fff").attr("stop-opacity",1),a.append("stop").attr("offset","75%").attr("stop-color","#fff").attr("stop-opacity",1),a.append("stop").attr("offset","100%").attr("stop-color","#fff").attr("stop-opacity",0))}},a}),function(t,e){var a="OMHWebVisualizations";t[a]=e(t,a),t[a].Utils={},t[a].Utils.mergeObjects=function(e,n){function i(i){if(void 0===o[i]){var r=e[i],s=n[i];typeof r!=typeof s||"object"!=typeof r||s instanceof Array?(o[i]=r,n.hasOwnProperty(i)&&(o[i]=s)):o[i]=t[a].Utils.mergeObjects(r||{},s||{})}}var o={};for(var r in e)i(r);for(r in n)i(r);return o}}(this,function(t,e){var a=t.hasOwnProperty(e)?t[e]:{};return a.Chart=function(t,e,a,n){var i,o=a.split(/\s*,\s*/),r=null,s=new OMHWebVisualizations.ChartConfiguration(o,n),l=new OMHWebVisualizations.DataParser(t,o,s),u=new OMHWebVisualizations.ChartStyles(s),c=new OMHWebVisualizations.ChartInteractions(e,s,l,u);this.initialized=!1,"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]),e.node||(e=d3.select(e)),n||(n={}),e.classed("omh-chart-container",!0),this.destroy=function(){c.destroy(),r&&r.destroy(),f&&m.offUpdate(f)},this.getComponents=function(){if(!this.initialized)return{};var t={};t[o[0]]=m;var e={};e[o[0]]=g;var a={};a[o[0]]=v;var n={};n[o[0]]=d;var i={};i[o[0]]=p;var s={};return s[o[0]]=E,D.forEach(function(n){t[n.measure]=n.scale,e[n.measure]=n.axis,a[n.measure]=n.label}),{xScales:n,yScales:t,colorScales:s,gridlines:{gridlines:_,yAxis:S,values:T},legends:[N],xAxes:i,yAxes:e,plots:b,yLabels:a,table:r,tooltip:c.getTooltip(),toolbar:c.getToolbar(),panZoomInteractions:{plotGroup:c.getPanZoomInteraction(),xAxis:c.getpanZoomInteractionXAxis()}}},this.getStyles=function(){return u},this.getInteractions=function(){return c},this.getConfiguration=function(){return s},this.getParser=function(){return l},this.getD3Selection=function(){return i};var d=new Plottable.Scales.Time,m=new Plottable.Scales.Linear,f=null,h=s.getPrimaryMeasureSettings().range;h&&m.domainMin(h.min).domainMax(h.max);var p=new Plottable.Axes.Time(d,"bottom").margin(15).addClass("x-axis"),g=new Plottable.Axes.Numeric(m,"left"),v=new Plottable.Components.AxisLabel(s.getPrimaryMeasureSettings().units,"0").padding(5).xAlignment("right").yAlignment("top"),b=[],y=(new Plottable.Plots.Scatter).x(function(t){return t.x},d).y(function(t){return t.y},m);u.setStylesForPlot(u.getDefaultStylesForPlot(y),y);var P=[],x=0,D=[];d3.entries(l.getAllMeasureData()).forEach(function(t){var e=t.key;"clustered_bar"===s.getMeasureSettings(e).chart.type&&x++});var _,S,T=[],w=function(t){t.max&&T.push(t.max),t.min&&T.push(t.min)};if(s.getInterfaceSettings().thresholds.show!==!1&&(o.forEach(function(t){var e=s.getMeasureSettings(t).thresholds;e&&w(e)}),T.length>0)){T.sort(function(t,e){return t-e});var A=new Plottable.Scales.Linear;A.domain(m.domain()),A.range(m.range()),f=function(t){A.domain(t.domain()),A.range(t.range())},m.onUpdate(f);var M=function(t){var e=T;return e};A.tickGenerator(M),S=new Plottable.Axes.Numeric(A,"right").tickLabelPosition("top").tickLabelPadding(1).showEndTickLabels(!0).addClass("gridlines-axis"),_=new Plottable.Components.Gridlines(null,A),b.push(_),b.push(S)}o.forEach(function(t){if(l.hasMeasureData(t)){var e=l.getMeasureData(t),a=new Plottable.Dataset(e),n=s.getMeasureSettings(t);if(a.measure=t,"clustered_bar"===n.chart.type){var i=m;if(P.length>0){var o=n.range,r=n.units;i=(new Plottable.Scales.Linear).domainMin(o.min).domainMax(o.max);var c=new Plottable.Axes.Numeric(i,"right"),f=new Plottable.Components.AxisLabel(r,"0").padding(5).xAlignment("left").yAlignment("top");D.push({measure:t,axis:c,label:f,scale:i})}var h=(new Plottable.Plots.ClusteredBar).x(function(t){return t.x},d).y(function(t){return t.y},i);u.setStylesForPlot(u.getDefaultStylesForPlot(h),h),P.push(h);for(var g=0;x>g;g++)h.addDataset(g===P.length-1?a:new Plottable.Dataset([]));var v=p.axisConfigurations(),_=[];v.forEach(function(t){("day"===t[0].interval||"month"===t[0].interval||"year"===t[0].interval)&&_.push(t)}),p.axisConfigurations(_),h.addClass("clustered-bar-plot-"+t),b.push(h)}else{var S=(new Plottable.Plots.Line).x(function(t){return t.x},d).y(function(t){return t.y},m);u.setStylesForPlot(u.getDefaultStylesForPlot(S),S),S.addDataset(a),y.addDataset(a),S.addClass("line-plot-"+t),b.push(S)}}}),y.addClass("point-plot"),b.push(y);var E=null,N=null;if(s.getInterfaceSettings().legend){E=new Plottable.Scales.Color,N=new Plottable.Components.Legend(E);var C=[],O=[];d3.entries(l.getAllMeasureData()).forEach(function(t){var e,a=t.key,n=s.getMeasureSettings(a),i=n.seriesName,o=n.chart.type;switch(o){case"clustered_bar":e=n.chart.barColor;break;default:e=n.chart.pointFillColor}i&&e&&(C.push(i),O.push(e))}),E.domain(C),E.range(O),N.maxEntriesPerRow(2),N.symbol(Plottable.SymbolFactories.square),N.xAlignment("right"),N.yAlignment("top"),b.push(N)}var I=s.getInterfaceSettings().axes.xAxis.visible,z=s.getInterfaceSettings().axes.yAxis.visible,F=new Plottable.Components.Group(b),U=z?new Plottable.Components.Group([g,v]):null,H=[U,F],Z=[null,I?p:null];z&&D.forEach(function(t){H.push(new Plottable.Components.Group([t.axis,t.label])),Z.push(null)}),r=new Plottable.Components.Table([H,Z]),r.yAlignment("bottom"),c.addToComponents({plots:b,plotGroup:F,table:r,xScale:d,xAxis:p}),this.renderTo=function(t){return this.initialized?(i=d3.select(t),c.addToSelection(i),r.renderTo(i),u.addToSelection(i),void c.addTooltipsToEntities(y.entities())):void console.log("Warning: chart could not be rendered because it was not successfully initialized.")},this.initialized=!0},a}),function(t,e){var a="OMHWebVisualizations";t[a]=e(t,a)}(this,function(t,e){var a=t.hasOwnProperty(e)?t[e]:{};return a.DataParser=function(t,e,a){var n=null,i={},o={ps:1e-9,ns:1e-6,us:.001,ms:1,sec:1e3,min:6e4,h:36e5,d:"d",wk:"w",Mo:"M",yr:"y"},r=function(){var a=JSON.parse(JSON.stringify(t));return n=this.parseOmhData(a,e,moment),0===Object.keys(n).length?(console.log("Warning: no data of the specified type could be found."),!1):void 0};return this.resolveKeyPath=function(t,e){if(void 0===t)return t;var a;"string"==typeof e?(i[e]||(i[e]=e.split(".")),a=i[e].slice()):a=e;try{if(e&&a.length>0)return this.resolveKeyPath(t[a.shift()],a)}catch(n){console.info("Exception while resolving keypath",n)}return t},this.getIntervalDisplayDate=function(t,e,a){var n=t.body.effective_time_frame.time_interval,i=n.start_date_time?new Date(n.start_date_time).getTime():null,r=n.end_date_time?new Date(n.end_date_time).getTime():null,s=n.start_date_time?e(n.start_date_time):null,l=n.end_date_time?e(n.end_date_time):null,u=n.duration?n.duration.value:null;if(u){var c,d=n.duration.unit,m=o[d];"string"!=typeof m?(c=u*m,i||(i=r-c),r||(r=i+c)):(i||(i=l.subtract(u,o[d]).valueOf()),r||(r=s.add(u,o[d]).valueOf()))}return new Date(i)},this.quantizeDate=function(t,e){var a=e<=OMHWebVisualizations.DataParser.QUANTIZE_MONTH?t.getMonth():6,n=e<=OMHWebVisualizations.DataParser.QUANTIZE_DAY?t.getDate():e===OMHWebVisualizations.DataParser.QUANTIZE_MONTH?15:1,i=e<=OMHWebVisualizations.DataParser.QUANTIZE_HOUR?t.getHours():e===OMHWebVisualizations.DataParser.QUANTIZE_DAY?12:0,o=e<=OMHWebVisualizations.DataParser.QUANTIZE_MINUTE?t.getMinutes():e===OMHWebVisualizations.DataParser.QUANTIZE_HOUR?30:0,r=e<=OMHWebVisualizations.DataParser.QUANTIZE_SECOND?t.getSeconds():e===OMHWebVisualizations.DataParser.QUANTIZE_MINUTE?30:0,s=e<=OMHWebVisualizations.DataParser.QUANTIZE_MILLISECOND?t.getMilliseconds():e===OMHWebVisualizations.DataParser.QUANTIZE_SECOND?500:0;return new Date(t.getFullYear(),a,n,i,o,r,s)},this.parseOmhData=function(t,e,n){var i=this,o={},r={},s={};return t&&0!==t.length?(e.forEach(function(t,e){r[t]=a.getMeasureSettings(t).timeQuantizationLevel,s[t]=a.getMeasureSettings(t).valueKeyPath}),t.forEach(function(t){t.groupName="",e.forEach(function(e,a){var l=i.resolveKeyPath(t,s[e]);if(void 0!==l&&"object"!=typeof l){t.groupName+="_"+e,o.hasOwnProperty(e)||(o[e]=[]);var u;t.body.effective_time_frame.date_time&&(u=i.quantizeDate(new Date(t.body.effective_time_frame.date_time),r[e])),t.body.effective_time_frame.time_interval&&(u=i.quantizeDate(i.getIntervalDisplayDate(t,n),r[e])),o[e].push({y:l,x:u,provider:t.header.acquisition_provenance.source_name,omhDatum:t,primary:0===a,measure:e})}})}),e.forEach(function(t,e){r[t]!==OMHWebVisualizations.DataParser.QUANTIZE_NONE&&i.consolidateData(t,o)}),o):o},this.consolidateData=function(t,e){var n=a.getMeasureSettings(t).quantizedDataConsolidationFunction;n(e[t])},this.getMeasureData=function(t){return n[t]},this.getAllMeasureData=function(){return n},this.hasMeasureData=function(t){return n.hasOwnProperty(t)},r.call(this)},a.DataParser.QUANTIZE_YEAR=6,a.DataParser.QUANTIZE_MONTH=5,a.DataParser.QUANTIZE_DAY=4,a.DataParser.QUANTIZE_HOUR=3,a.DataParser.QUANTIZE_MINUTE=2,a.DataParser.QUANTIZE_SECOND=1,a.DataParser.QUANTIZE_MILLISECOND=0,a.DataParser.QUANTIZE_NONE=-1,a.DataParser.consolidators={},a.DataParser.consolidators.summation=function(t){t.sort(function(t,e){return t.x.getTime()-e.x.getTime()});for(var e=0;e<t.length;e++)for(;e+1<t.length&&t[e+1].x.getTime()===t[e].x.getTime();)t[e].y+=t[e+1].y,t[e].consolidatedData||(t[e].consolidatedData=[t[e].omhDatum]),t[e].consolidatedData.push(t[e+1].omhDatum),t[e].consolidationType="summation",t.splice(e+1,1)},a.DataParser.consolidators.average=function(t){a.DataParser.consolidators.summation(t);for(var e=0;e<t.length;e++){var n=t[e].consolidatedData?t[e].consolidatedData.length:0;n>0&&(t[e].y/=n,t[e].consolidationType="average")}},a});